<!DOCTYPE html>












  


<html class="theme-next muse use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">


























<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/css/main.css?v=7.0.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=7.0.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=7.0.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=7.0.0">


  <link rel="mask-icon" href="/images/logo.svg?v=7.0.0" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '7.0.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="zh-CN">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Hexo">






  <link rel="canonical" href="http://yoursite.com/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>Hexo</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Hexo</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home menu-item-active">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档</a>

  </li>

      
      
    </ul>
  

  
    

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/04/09/微信小程序API/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/04/09/微信小程序API/" class="post-title-link" itemprop="url">微信小程序API</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-04-09 23:34:17 / 修改时间：23:40:30" itemprop="dateCreated datePublished" datetime="2019-04-09T23:34:17+08:00">2019-04-09</time>
            

            
              

              
            
          </span>

          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="API"><a href="#API" class="headerlink" title="API"></a>API</h1><h2 id="1-路由API"><a href="#1-路由API" class="headerlink" title="1. 路由API"></a>1. 路由API</h2><pre><code>跟界面切换相关的API

复习:

    A =&gt; B
        组件:  &lt;navigator url=&quot;/pages/b/b&quot;&gt;
        API:    wx.navigateTo({
            url:&quot;/pages/b/b&quot;
        })


   A =&gt; B 返回 A
        导航栏左上角 自动添加返回按钮
        API:    wx.navigateBack()


    A界面, B界面替换A界面
        组件:  &lt;navigator url=&quot;/pages/b/b&quot; open-type=&quot;redirect&quot;&gt;
        API:    wx.redirectTo({
            url:&quot;/pages/b/b&quot;
        })


    tabbar(A,B,C,D)
        组件:  &lt;navigator url=&quot;/pages/b/b&quot; open-type=&quot;switchTab&quot;&gt;
        API:    wx.switchTab({
            url:&quot;/pages/b/b&quot;
        })
</code></pre><h2 id="2-界面交互API"><a href="#2-界面交互API" class="headerlink" title="2.界面交互API"></a>2.界面交互API</h2><pre><code>消息框

    q.基本使用

        wx.showToast({
            title: &apos;注册成功注册成功,注册成功,注册成功&apos;,
        })

        注意: 最多显示7个汉字

    q.额外属性
        //duration 持续时间
        wx.showToast({
            title: &apos;注册成功注册成功,注册成功,注册成功&apos;,
            duration: 4000
        })



模态框
    q.基本使用
        wx.showModal({
            title: &apos;我是标题&apos;,
            content: &apos;注册成功注册成功,注册成功,注册成功注册成功注册成功,注册成功,注册成功&apos;,
        })

    q.其他使用
        //添加点击确定回调, shoCancle 不显示取消按钮
        wx.showModal({
            title: &apos;我是标题&apos;,
            content: &apos;注册成功注册成功,注册成功,注册成功注册成功注册成功,注册成功,注册成功&apos;,
            success: function(){
                console.log(&quot;ok&quot;)
            },
            showCancel:false
        })


loading/关闭loading

    q.基本使用
        //开始下载前显示loading
        wx.showLoading({
            title: &apos;正在加载中&apos;,
        })

        //模拟数据下载
        setTimeout(function(){

            //一定要放在, 数据下载回调函数中
            wx.hideLoading()

        },3000)
</code></pre><h2 id="3-界面tabbar标签"><a href="#3-界面tabbar标签" class="headerlink" title="3. 界面tabbar标签"></a>3. 界面tabbar标签</h2><pre><code>标签栏设置(小红点, 显示和隐藏标签栏)

显示小红点
    q.如何显示
        onLoad或者onReady执行函数
        wx.showTabBarRedDot({
            index: 1,
        })

        注意: index表示序号, 默认从0开始

显示标签栏附加文本

    q.基本使用
    wx.setTabBarBadge({
        index: 0,
        text: &apos;99+&apos;,
    })


显示或者隐藏标签栏

    注意: 在其他界面上, 会自动隐藏, 手动隐藏通过API
    dealShow(){
        wx.showTabBar({

        })
    },

    dealHide() {
        wx.hideTabBar({

        })
    },
</code></pre><h2 id="4-界面下拉刷新和加载更多"><a href="#4-界面下拉刷新和加载更多" class="headerlink" title="4.界面下拉刷新和加载更多"></a>4.界面下拉刷新和加载更多</h2><pre><code>复习:

下拉刷新
    注意配置
        &quot;enablePullDownRefresh&quot;:true

    生命周期函数
        onPullDownRefresh: function () {

        },

到达底部-加载更多
    onReachBottom: function () {

    }
</code></pre><h2 id="5-网络请求-最常用的功能"><a href="#5-网络请求-最常用的功能" class="headerlink" title="5.网络请求(最常用的功能)"></a>5.网络请求(最常用的功能)</h2><pre><code>请求类型
    GET
    POST
    POST(上传文件)

GET请求和POST
    GET: 
    wx.request({
        url:&quot;&quot;,
        data:{},
        method:&quot;GET&quot;,
        success:(res)=&gt;{

        }
    })

    POST: 
    wx.request({
        url:&quot;&quot;,
        data:{},
        method:&quot;POST&quot;,
        success:(res)=&gt;{

        }
    })

上传文件
    wx.uploadFile(Object object)

    文艺范项目:  上传用户头像
</code></pre><h2 id="6-持久化数据存储"><a href="#6-持久化数据存储" class="headerlink" title="6.持久化数据存储()"></a>6.持久化数据存储()</h2><pre><code>简介:
    存储一个登陆信息, 下次启动再用
    html - localStorage 存储, cookie, html5(WebSQL, Indexed DB)
    微信 类似

    场景: 记住用户名


q.基本操作

    存储值: wx.setStorageSync(&quot;name&quot;, arr);
    获取值: var name = wx.getStorageSync(&quot;name&quot;)
    移除值: wx.removeStorageSync(&quot;name&quot;)
    清除所有: wx.clearStorageSync()

    注意: Sync表示同步, 函数执行完了操作也完了
</code></pre><h2 id="7-定位API"><a href="#7-定位API" class="headerlink" title="7.定位API"></a>7.定位API</h2><pre><code>复习: 
    wx.getLocation() 定位

    //打开地图位置
    wx.openLocation(Object object)
</code></pre><h2 id="8-用户登陆-用户信息"><a href="#8-用户登陆-用户信息" class="headerlink" title="8. 用户登陆/用户信息"></a>8. 用户登陆/用户信息</h2><pre><code>复杂的逻辑

函数
    wx.login(Object object)  登陆函数
    wx.checkSession(Object object)  检查是否登陆过期


获取用户信息:
    &lt;1&gt; 某个界面, 添加一个按钮, 类型注意是  open-type=&quot;getUserInfo&quot;
        &lt;button  open-type=&quot;getUserInfo&quot; bindgetuserinfo=&quot;getUserInfo&quot;&gt; 获取头像昵称 &lt;/button&gt;

    &lt;2&gt; 获取用户信息
        getUserInfo: function (e) {
            //e.detail.userInfo

            //昵称
            e.detail.userInfo.nickName

            //头像
            e.detail.userInfo.avatarUrl
        }


项目:
    注意: 不仅仅是拿到昵称和头像

    &lt;1&gt; 微信小程序 调用wx.login 获取一个code

    &lt;2&gt; 微信小程序通过wx.request发送code给自己的服务器

    &lt;3&gt; 服务器执行  auth.code2Session 发请求给微信服务器
        appid appsecret(上线前注册微信小程序账号, 得到这两个), code
        返回 openid, session_key, 做出处理, 生成账号, 返回给小程序
</code></pre><h2 id="9-状态-网络状态"><a href="#9-状态-网络状态" class="headerlink" title="9. 状态 - 网络状态"></a>9. 状态 - 网络状态</h2><pre><code>获取和监控网络状态

总结:
    获取当前网络状态  wx.getNetworkType()
    监控网络状态变化 wx.onNetworkStatusChange()
</code></pre><p>##10. 设备</p>
<pre><code>从相册选择图片(必用, 上传头像)

    q.基本使用
        wx.chooseImage() 

        注意: 选择图片既可以从相册选择, 也可以拍照

打电话(用的很多, )

    q.基本使用
        wx.makePhoneCall()


扫二维码

    // 只允许从相机扫码
    wx.scanCode({
        onlyFromCamera: false,
        success(res) {
            console.log(res)

            //扫码结果 res.result
            self.setData({
            result: res.result
            })
        }
    })
</code></pre>
          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/04/09/微信小程序-基础知识/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/04/09/微信小程序-基础知识/" class="post-title-link" itemprop="url">微信小程序--基础知识</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-04-09 23:27:57 / 修改时间：23:30:46" itemprop="dateCreated datePublished" datetime="2019-04-09T23:27:57+08:00">2019-04-09</time>
            

            
              

              
            
          </span>

          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="微信小程序基础"><a href="#微信小程序基础" class="headerlink" title="微信小程序基础"></a>微信小程序基础</h1><p>##1. 微信小程序介绍</p>
<pre><code>q. 什么是微信小程序, 优势是什么, 劣势是什么?

    微信小程序是腾讯集团为微信开发中实现编写App的技术, 
    可以使用js语言和微信小程序相关组件, API编写App
    运行在微信环境之下

    优势:  1.背靠腾讯爸爸, 流量比较大
                2. 跨平台特性,  写App, 以前iOS, Android, 现在直接写
                3. 提供的功能相对比较丰富的, 比web开发功能丰富
                4. 界面使用数据绑定机制,  帮助降低开发难度
                5. 使用人群比较广, 很多小的公司, 小商铺都需要做微信小程序

    劣势:  受到腾讯控制比较强, 限制比较多......

q.相关资源资料
    官网:  https://mp.weixin.qq.com/cgi-bin/wx
    文档:  https://developers.weixin.qq.com/miniprogram/dev/index.html
</code></pre><p>##2. 微信小程序环境搭建</p>
<pre><code>q.如何下载开发者工具
    地址: https://developers.weixin.qq.com/miniprogram/dev/devtools/devtools.html

    注意:  分为win32, win64, macos

q.如何安装开发者工具

    直接安装

q.如何启动进入工具

    注意: 启动需要扫码登陆, 让电脑一直联网
</code></pre><p>##3. 项目创建</p>
<pre><code>q.如何创建项目

    &lt;1&gt;先创建一个空文件夹
    &lt;2&gt;打开开发者工具, 选择小程序
    &lt;3&gt;输入信息
            项目名称随意
            目录选择刚才的空文件夹
            AppId 暂时使用测试号
            语言选择js
    &lt;4&gt;点击创建

q.开发者工具各个区域,按钮的功能?
    菜单栏
    工具栏
    模拟器
    代码编辑器
    调试区域

q.项目中各个文件的解释
    project.config.json  项目配置文件
        重要属性 appid, projectname
    app.js  程序入口文件
        主要创建了一个App对象, 表示整个程序, 有个函数onLanch, 自动执行, 程序加载执行

    app.json
        重要属性 pages, 所有界面都要把地址放在这儿
        重要属性 window, 配置颜色
        重要属性 tabBar,  添加底部标签栏

    app.wxss 样式文件, 放的就是css, 里面加的样式, 所有界面通过


    一个界面由4个文件构成
        test.wxml               界面结构文件, 里面类似html, 放的是微信小程序组件
        test.wxss               界面样式文件, 里面就是css,   样式优先级要比 app.wxss要高
        test.js                 界面逻辑文件,  创建Page对象, 
                                核心函数  onLoad, 界面加载执行
        test.json               页面配置文件, 这里面配置优先级要比app.json高
</code></pre><p>##4. 页面的创建</p>
<pre><code>q.如何通过app.json的pages创建新页面?

    在pages添加路径, 保存自动创建

    特别注意:  pages第一个路径, 就是默认显示首页

q.如何通过新建文件, 新建界面
    &lt;1&gt; 先在pages新建文件夹
    &lt;2&gt; 在文件夹里面 新建Page, 

    注意:  同时生成4个文件, 会把路径加到pages中
</code></pre><p>##5. 第一个简易程序<br>    计算两数之和<br>    核心知识:<br>        <1> wxml中添加组件<br>        <2>wxss中添加样式<br>        <3> 如何js中数据, 显示到wxml   数据绑定机制<br>        <4> 界面中输入框改变数据, 如何同步到js中<br>        <5> 如何修改数据, 界面同步显示</5></4></3></2></1></p>
<pre><code>步骤:
    Step1: 构建界面
        view  ==&gt; div
        text ===&gt; span
        input ===&gt; input
        button ===&gt; button
        注意:  input  默认没有边框,  100%宽度
                    按钮 默认100%宽度

    Step2: 添加样式
        和css类型, class和id, 添加样式

    Step3:  如何把js中的数据, 显示到界面上
        思路:  先拿到dom节点, 再去操作dom节点,  微信小程序中,没有dom, 没有bom, html事件不支持
        新思路:  数据渲染到页面中, 通过修改数据, 页面自动更新

        注意:  格式    {{变量名}}      js的data中定义变量

    Step4: 修改js的变量, 如何让界面更新

        js中修改data中的值, 不要直接修改, 而是要使用  
        this.setData({
            num1: 100 
        })

    Step5: 输入框中值改变了, 如何同步到变量?
        input添加bindinput对应的事件处理函数

        事件处理函数参数event中detail.value是最新的值

        最新的值存储起来,  更新到data中, 实现效果
        &lt;input bindinput=&quot;dealInput1&quot;&gt;
        dealInput1(event){
            this.setData({
            num1: event.detail.value
            })
        },
</code></pre><p>##6.  数据绑定机制</p>
<pre><code>解决问题: 如何把不同的数据渲染到网页中

q. {{}}能放什么?
    能放表达式    10*(2-4)

q.data中普通变量如何渲染?
    sum:10
    {{sum}}

q.data中有个数组如何渲染 - [循环渲染]

   数据:     list:[10,20,30,40,50]

    渲染: 
    &lt;view wx:for=&quot;{{list}}&quot; wx:key=&quot;{{index}}&quot;&gt;
        {{index}} - {{item}}
    &lt;/view&gt;

    注意:  index和item是默认值

    注意:  一种情况 数组中不是普通数据, 而是一个一个对象, 渲染时候
     &lt;view wx:for=&quot;{{goods}}&quot; wx:key=&quot;{{index}}&quot;&gt;
        &lt;view&gt;===============&lt;/view&gt;
        &lt;view&gt;{{item.id}}&lt;/view&gt;
        &lt;view&gt;{{item.name}}&lt;/view&gt;
        &lt;view&gt;{{item.num}}&lt;/view&gt;
        &lt;view&gt;{{item.price}}&lt;/view&gt;
    &lt;/view&gt;

q.如何显示或者隐藏一个组件
   数据:    isShow:false

    界面:  
         &lt;view wx:if=&quot;{{isShow}}&quot;&gt;
            我是内容内容
        &lt;/view&gt;
</code></pre><p>##7.  生命周期函数</p>
<pre><code>q.生命周期函数是什么, 作用是什么?
    一个页面有生命周期,   创建, 显示, 销毁
    生命周期函数就是微信小程序提供的一些钩子函数, 自动执行的, 在这些钩子函数中执行一些我们自己的操作

q.生命周期函数有哪些?
    onLoad: function (options)     页面加载执行, 执行一次, options上个界面的参数
    onReady: function ()              监听页面初次渲染完成
    onShow: function ()             监听界面显示,  界面显示一次, 执行一次
    onHide: function ()             监听页面隐藏, 每次隐藏执行一次
    onUnload: function ()       监听页面卸载,  一次
    onPullDownRefresh: function ()      监听用户下拉
    onReachBottom: function ()              监听到达页面底部,  实现上啦加载更多
    onShareAppMessage: function ()      监听点击分享

    介绍, 具体使用还在以后
</code></pre><p>##8. 简易计算器</p>
<pre><code>功能:
    计算器, 支持常用数学计算, 支持整数, 支持小数
        计算支持  + - * / %  +/-
        支持 AC 清空数据库

难点: 
    1. 有些按钮需要特殊布局
        {
            title:&quot;1&quot;,
            className:&quot;btn zero&quot;
        }
    2.多个按钮, 用同一个事件处理函数处理, 如何区分多个按钮
        &lt;button bindtap=&quot;dealTap&quot; id=&quot;10&quot;&gt;

    3.如何实现数学计算
        难的 - 表达式 =&gt; 表达式计算问题 -&gt; 算法 -&gt; 栈,  中序表达式转成后序表达式
        解决:  用第三方库
</code></pre>
          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/04/09/微信小程序组件/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/04/09/微信小程序组件/" class="post-title-link" itemprop="url">微信小程序组件</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-04-09 20:14:44 / 修改时间：20:16:27" itemprop="dateCreated datePublished" datetime="2019-04-09T20:14:44+08:00">2019-04-09</time>
            

            
              

              
            
          </span>

          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="微信小程序的组件-html中不同标签"><a href="#微信小程序的组件-html中不同标签" class="headerlink" title="微信小程序的组件(html中不同标签)"></a>微信小程序的组件(html中不同标签)</h1><h2 id="1-第一部分-最常用"><a href="#1-第一部分-最常用" class="headerlink" title="1. 第一部分 - 最常用"></a>1. 第一部分 - 最常用</h2><pre><code>view                    视图容器  (html - div)
text                    文本组件 (html-span)
button                  按钮组件 (html-button)
image                   图片组件 (html-img)

    q. 如何使用image标签
        添加image标签, 设置sr路径, 路径添加本页面相对于图片相对路径

    q.image的mode常用有哪些?
        mode默认值是scaleToFill, 不保持纵横比, 会拉伸


navigator           页面链接组件 (html-a)

    q.这个组件是干嘛用?
        实现界面的跳转, 使用这个组件

    q.这个组件如何使用?
        核心属性:
            url         跳转的页面路径, 例如  pages/test/test
                        添加参数    pages/test/test?id=10

            open-type
                navigate    对应 wx.navigateTo 或 wx.navigateToMiniProgram 的功能    
                    A=&gt;B  A存在
                redirect    对应 wx.redirectTo 的功能    
                    A=&gt;B  A不存在
                switchTab    对应 wx.switchTab 的功能    
                    tab(A,B,C)      A=&gt;B
                reLaunch    对应 wx.reLaunch 的功能    1.1.0
                    A   重新加载A
                navigateBack    对应 wx.navigateBack 的功能    1.1.0
                    A=&gt;B,    B=&gt;A
                exit    退出小程序，target=&quot;miniProgram&quot;时生效
                    A,B         退出小程序

        注意:  url中传递的是路径, 就有两种路径,  相对路径和绝对路径

        出错:  直接使用  app.json中路径, 会出错

    q.如何从A界面传值到B界面

        举例:   一个列表页挑战到详情页,  需要传递id到详情页
                list                detail
                item1
                item2
                item3

        &lt;1&gt;在界面跳转的时候加入参数, 例如&quot;/pages/5-navigate/page2 
            变成 &quot;/pages/5-navigate/page2?id=10
        &lt;2&gt; 在第二个界面的onLoad中在options中获取id

练习: 人人界面
</code></pre><h2 id="2-第二部分-常用小型组件"><a href="#2-第二部分-常用小型组件" class="headerlink" title="2. 第二部分 - 常用小型组件"></a>2. 第二部分 - 常用小型组件</h2><pre><code>input
    q. input组件常用属性有哪些? 如何使用

        value 值
        type   默认text


        注意: input默认样式没有边框


    q. 如何通过一个事件处理函数处理input输入


label

radio
checkbox

slider
switch
textarea
progress
rich-text
    q.如何使用
        添加组件, 设置nodes为一个html字符串

        注意: rich-text 只支持部分标签, 具体看文档,  支持样式, 样式可以写在页面wxss
                rich-text   img 标签仅支持网络图片
                    image src=&quot;/assets/img.png&quot;
                     image src=&quot;http://www.host.com/assets/img.png&quot;   网络图片
                rich-text   支持class和style, id选择器不支持
                rich-text   里面事件不可用

icon
form
    所有的输入的内容放到form组件内
    需要给form中输入组件添加name
    form的最后添加button,  设置form-type=&quot;submit&quot;
    给form添加事件处理函数  bindsubmit=&quot;dealSubmit&quot;

    注意: form不是必须的, 
        多个输入组件, 收集输入的数据, 
        方式1: 每个输入框关联一个变量, 获取这些变量
        方式2: 所有输入组件放到form中, 每个输入组件记得加上name,  form的submit中得到所有输入组件的数据
</code></pre><h2 id="3-导航栏-标签栏-没有组件"><a href="#3-导航栏-标签栏-没有组件" class="headerlink" title="3. 导航栏/标签栏(没有组件)"></a>3. 导航栏/标签栏(没有组件)</h2><pre><code>标签栏
    app.json - tabBar

导航栏

实现一个微信程序框架

Step1: 创建项目
Step2: 实现4个界面切换(以前navigator, 现在用标签栏)
    &lt;1&gt; 创建4个界面
    &lt;2&gt; 在app.json中添加属性 tabBar    (注意: tabBar b是大写)
            必须有个有属性list, 放标签栏所有标签项的配置, 最少2个,最多5个
            每个添加  pagePath页面路径
                text 文本
                iconPath 正常装填图片
                selectedIconPath 选择的图片

            注意:  标签显示有条件,  标签栏中某个界面路径必须要挡在pages最前面

    &lt;3&gt;标签栏各种配置
        &quot;color&quot;:&quot;#ccc&quot;, 
        &quot;selectedColor&quot;:&quot;#62ee18&quot;,
        &quot;backgroundColor&quot;:&quot;#fff&quot;,
        &quot;borderStyle&quot;:&quot;black&quot;,
        &quot;position&quot;:&quot;bottom&quot;,


    &lt;4&gt;全局配置导航栏
        app.json加在window对象
            navigationBarBackgroundColor   导航栏背景色
            navigationBarTextStyle                  导航栏文字样式 white/black
            navigationBarTitleText                  导航栏文字



    &lt;5&gt;各页面导航栏配置
        page.json中, 直接加在配置{}中
            &quot;navigationBarBackgroundColor&quot;: &quot;#ccc&quot;,
            &quot;navigationBarTitleText&quot;: &quot;微信&quot;,
            &quot;navigationBarTextStyle&quot;: &quot;black&quot;
</code></pre><h2 id="4-滚动-滑动"><a href="#4-滚动-滑动" class="headerlink" title="4. 滚动/滑动"></a>4. 滚动/滑动</h2><pre><code>原生滚动
    注意1:  界面上内容超出界面高度,  微信小程序自动添加竖直滚动功能

    注意2: 界面内容超度界面宽度,  网页加滚动条,  微信小程序没有加,不会加

    注意3: 界面内 通过  overflow-x:scroll和overflow-y:scroll 实现横向和竖向滚动


scroll-view  滚动视图

    q.基本使用
        写个scroll-view, 里面添加子元素, 可以添加多个子元素, wxss设置scroll-view高度
        默认不能滚动, 需要通过scroll-x或者scroll-y开启滚动

    q.  设置跳转到某个子元素
        &lt;1&gt; 每个子元素添加id, 注意id不能以数字开头
        &lt;2&gt; 定义变量 currentId,  表示当前滚动到子元素的id
        &lt;3&gt; 给scroll-view添加属性  scroll-into-view=&quot;{{currentId}}&quot;

        &lt;4&gt; 那个按钮点击了, 获取id, 生成最新currentId,   同步数据 this.setData()


swiper              滑块视图容器(轮播图组件)
    q.如何实现轮播图
            html - 自己实现(技术不强, 很烂)
            html - swiper2/swiper4, superslide
            微信小程序 - swiper组件

    q.如何实现- 最简单
        &lt;swiper-item wx:for=&quot;{{list}}&quot; wx:key=&quot;{{index}}&quot;&gt;
            &lt;image src=&quot;{{item.img}}&quot;&gt;&lt;/image&gt;
        &lt;/swiper-item&gt;

    q. 添加小圆点
        使用属性: 
            indicator-dots   是否显示
            indicator-color  默认颜色
            indicator-active-color  激活颜色

    q.如何设置循环滚动
        circular = true

    q.设置自动滚动
        autopaly=true

    q.设置间隔时间
         interval=&apos;3000&apos;  单位是毫秒

    q.如何监控显示滚动到第几个?
        bindchange=&quot;dealChange&quot;
        事件处理函数中, e.detial会有当前的序号

    q.如何实现竖向轮播图
        vertical=&quot;true&quot;


refresh
    下拉刷新 - 网络数据 - 重新下载新的数据

    &lt;1&gt; app.josn的window中, 或者在page.json添加一个属性, 开启下拉刷新
            &quot;enablePullDownRefresh&quot;:true

    &lt;2&gt; 每个界面生命周期函数  onPullDownRefresh: function () 会执行

            常见操作: 
                page=1
                下载数据  downloadData

    &lt;3&gt; downloadData
            现在: setTimeout 延时
            以后: 发起网络请求

            注意: 请求完成之后  下拉刷新 - 让新的数据替换旧的的数据
                this.setData({
                    list:list
                })

loadmore
    加载更多 - 界面很多条数据, 滚动到最底部, 加载更多, 下载新的数据, 附加在原来数据的后面

    &lt;1&gt;每个界面生命周期函数  onReachBottom: function () 会执行

        常见操作: 
                page+=1
                下载数据  downloadData

    &lt;2&gt; downloadData中
        注意: 请求完成之后  下拉刷新 - 让新的数据附加到原来数据的后面
</code></pre><h2 id="5-多媒体"><a href="#5-多媒体" class="headerlink" title="5.多媒体"></a>5.多媒体</h2><pre><code>q.微信小程序中支持的媒体形式有哪些?

    image 图片组件
    audio 音频组件
    video 视频
    camara 摄像
    live-pusher  在线推送
    live-player 在线播放

video 播放视频

    q. 如何播放视频
        html4 - flash / 浏览器插件(快播/西瓜视频/百度视频)
        html5 - video标签
        微信小程序  video 标签

    q.iOS和Android同时支持的格式
        mp4, 3gp, m3u8流媒体格式

    q. video最简单的使用方式是啥?
        先添加video标签, 设置src
            src可以是本地视频, 除非视频特别小, 不要放在本地
            src可以是远程网址  (推荐的方式)

    q.常见的属性有哪些?
        src   本地地址, 网络地址
        duration    默认就是视频长度, 也可以设置, 一般不设置
        .....

    q.如何使用弹幕 *****
        &lt;1&gt; 开启弹幕
            enable-danmu=&quot;true&quot;

        &lt;2&gt;设置弹幕数据   danmu-list=&quot;{{list}}&quot;
            [
                {
                    text:
                    color:
                    time:
                }
            ]

        &lt;3&gt;如何添加弹幕
            数组中添加对象
            {
                text:
                color:
                time:
            }

    q.如何使用常用事件处理函数
        bindplay
        bindpause
        bindended           播放列表 - 自动播放下一个
        binderror

    q.如何通过js去操作视频组件

        &lt;1&gt; 给组件添加id
        &lt;2&gt; 通过函数 wx.createVideoContext(&apos;myVideo&apos;)  创建视频上下文
                理解: 得到了视频组件对应的对象
        &lt;3&gt; 执行操作
            paly()
            pause()
            stop()
            ....




audio 播放音频

    q.微信小程序中如何播放音乐
        方式1: 使用audio组件 ,1.6.0不维护了, 推荐 InnerAudioContext
        方式2: 使用InnerAudioContext

    q.支持哪些音乐格式
        m4a
        mp3   ***最多
        wav
        aac

    q.如何使用
        先创建对象
        在设置src属性
        最后执行play()

    q.如何控制音量
        &lt;1&gt; 添加了slider  min=0 max=1 step=0.01
        &lt;2&gt; slider添加处理事件
            获取当前值  e.detail.value 
        &lt;3&gt; 设置当前音量
            this.audioContext.volume = e.detail.value

    q.如何显示进度?
        &lt;1&gt; 添加 progress
        &lt;2&gt; 定义变量   pecent
        &lt;3&gt; 监听 音频 进度更新事件
            audioContext.onTimeUpdate(()=&gt;{

            })
</code></pre><h2 id="6-地图"><a href="#6-地图" class="headerlink" title="6.地图"></a>6.地图</h2><pre><code>location 定位

map 组件


1. 简介
    q.定位和地图在什么地方使用？ 作用

        通讯类： 同城交友，摇一摇，漂流瓶， 附近的人
            陌陌

        购物类
        旅游类

    q.需求
        获取当前的位置 
            H5  定位API - 授权
            微信小程序 API

        获取当前的城市
            现先获取经纬度， 在获取（百度api）当前城市


        显示地图
            APP 商家，餐馆， 位置

        导航
            地图导航

2. 定位
    q. 在地球上如何进行定位？
        GPS卫星
        北斗导航系统

    q.经纬度
        经度       360度，  东经180度， 西经180度，  格林尼治天文台 0度
        纬度       赤道0度， 向北一直到北极， 北纬90，  南边类型


    q.当前经纬度
        40.1451662768,116.2895107269


        //40.146648
        //116.290785

    q.通过API获取经纬度
        &lt;1&gt; 添加权限
            //app.json加入
            &quot;permission&quot;: {
                &quot;scope.userLocation&quot;: {
                &quot;desc&quot;: &quot;你的位置信息将用于小程序位置接口的效果展示&quot;
                }
            }

        &lt;2&gt; 调用wx.getLocation() 函数
            var self = this

            //注意: type一般选择gcj02, 高德地图,腾讯地图默认支持
            //  res返回地理信息,  res.longitude是经度, res.latitude是纬度
            wx.getLocation({
                type:&quot;gcj02&quot;,
                altitude:true,
                success: function (res) {

                    console.log(res)

                    self.setData({
                    res:res
                    })


                },
            })

3.地图

    q.基本显示
        //添加map标签
        &lt;map&gt;&lt;/map&gt;

    q.如何显示当前区域
        longitude=
        latitude=
        scale

    q.地图覆盖物

        markers 大头针

        polyline 折线(路线)

        circles 圆  (圆形区域)

        polygons 多边形
</code></pre>
          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/18/弹性容器/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/03/18/弹性容器/" class="post-title-link" itemprop="url">弹性容器</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-03-18 17:16:56 / 修改时间：23:41:57" itemprop="dateCreated datePublished" datetime="2019-03-18T17:16:56+08:00">2019-03-18</time>
            

            
              

              
            
          </span>

          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>###弹性盒子<br>弹性盒子是CSS3的一种新的布局模式.<br>CSS3弹性盒子(Flexible Box 或flexbox), 是一种当页面需要适应不同的屏幕大小以及设备类型时确保元素拥有恰当的行为的布局方式.<br>引入弹性盒子布局模型的目的是提供一种更加有效的方式来对一个容器中的子元素进行排列.对齐和分配空白空间.</p>
<p>###浏览器支持<br>五大浏览器</p>
<p>###弹性盒子内容<br>① 弹性盒子由弹性容器和弹性子元素组成.<br>② 弹性容器通过设置 display 属性的值为 flex 或 inline-flex 其定义为弹性容器.<br>③ 弹性容器包含了一个或多个弹性子元素.<br><strong>注意:</strong>弹性容器外及弹性子元素内是正常渲染.弹性盒子只定义了弹性子元素如何在弹性容器内分布.<br>弹性子元素通常在弹性盒子内一行显示.默认情况每个容器只有一行.<br>以下元素展示了弹性子元素在一行内显示,从左到右.<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">__实例__</span><br><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">    .flex-container&#123;</span></span><br><span class="line"><span class="undefined">        display:flex;</span></span><br><span class="line"><span class="undefined">        width:100%;</span></span><br><span class="line"><span class="undefined">        height:300px;</span></span><br><span class="line"><span class="undefined">        background:red;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined">    .flex-item&#123;</span></span><br><span class="line"><span class="undefined">        width:30%;</span></span><br><span class="line"><span class="undefined">        height:300px;</span></span><br><span class="line"><span class="undefined">        background:yellow;</span></span><br><span class="line"><span class="undefined">        border:1px solid #ccc;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"flex-container"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"flex-item"</span>&gt;</span>flex item 1<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"flex-item"</span>&gt;</span>flex item 2<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"flex-item"</span>&gt;</span>flex item 3<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>我们可以修改排列方式.<br>如果我们设置 direction 属性为 rtl(right-top-left),弹性子元素的排序方式也会改变,页面布局也跟着改变.</p>
<p>direction : ltr 为默认; 从左到右<br>direction : rtl 从右到左</p>
<p><strong>flex-direction</strong><br>flex-direction属性指定了弹性子元素在父容器中的位置.<br><strong>语法</strong><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flex-direction: row | row-reverse | column | column-reverse</span><br></pre></td></tr></table></figure></p>
<p>flex-direction的值有:<br>· row: 横向从左到右排列 (左对齐) , 默认的排列方式<br>· row-reverse: 反转横向排列 (右对齐,从后往前排,最后一项排在最前面.)<br>· column: 纵向排列.<br>· column-reverse: 反转纵向排列,从后往前排,最后一项排在最上面.</p>
<p>以下实例演示了row-reverse 的使用<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">__实例__</span><br><span class="line">往父元素加 </span><br><span class="line">display:flex;</span><br><span class="line">flex-direction:row-reverse;</span><br></pre></td></tr></table></figure></p>
<p>以下实例演示column-reverse;<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">给父元素加</span><br><span class="line">flex-direction:column-reverse;</span><br></pre></td></tr></table></figure></p>
<p><strong>justify-conntent 属性</strong><br>内容对齐 (justify-content) 属性应用在弹性容器上,把弹性项沿着弹性容器的主轴 (main axis :主要 轴) 对齐.<br>justify-content 语法如下:<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">justify-content: flex-start | flex-end | center | space-between | space-sround</span><br></pre></td></tr></table></figure></p>
<p>各个值解析:<br> · flex-start<br>     弹性项目向行头紧挨着填充.这个是默认值.第一个弹性项的 main-start外边距边线被放置在该行的main-start边线.而后续弹性项依次平齐摆放.<br> · flex-end:<br>     弹性项目向行尾紧挨着填充.第一个弹性项的main-end 外边距边线被放置在该行的 main-end边线,而后续弹性项依次平齐摆放.</p>
<p> · center:<br>     弹性项目军中紧挨着填充, (如果剩余的自由空间是负的,则弹性项目将在两个方向上同时溢出).<br> · space-between:<br>     弹性项目平均分布在该行上,如果剩余空间为负或者只有一个弹性项,则该值等同于 flex-start. 否则,第 1 个弹性项的外边距和行的 main-start 边线对齐,而最后1个弹性项的外边距和行的 main-end 边线对齐,然后剩余的弹性项分布在该行上.相邻项目的间隔相等.<br> · space-around:<br>     弹性项目平均分布在该行上,两边留有一半的间隔空间,如果剩余空间为负或者只有一个弹性项,则该值等同于 center 否则 弹性项目 沿该行分布,且彼此间隔相等 (比如是20px), 同时首尾两边和弹性容器之间留有一半的间隔 (1/2*20px = 10px).</p>
<p><strong>align-items属性</strong></p>
<p>align-items 设置或检索弹性盒子元素在侧轴 (纵轴) 方向的对齐方式.<br><strong>语法</strong><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">align-items: flex-start | flex-end | cneter | baseline | stretch</span><br></pre></td></tr></table></figure></p>
<p>各个值解析:<br>· flex-start: 弹性盒子元素的侧轴 (纵轴) 起始位置的边界紧靠住该行的侧轴起始边界<br>· flex-end: 弹性盒子元素的侧轴 (纵轴) 起始位置的边界仅靠住该行的侧轴结束边界<br>· center: 弹性盒子元素在该行的侧轴 (纵轴) 上局中放置 (如果该行的尺寸小于弹性盒子元素的尺寸,则会向两个方向溢出相同的长度)<br>· baseline: 如弹性盒子元素的行内轴与侧轴为同一条,则该值与 “flex-start”等效,其它情况下,该值参与基线对齐<br>· stretch: 如果指定侧轴大小的属性值为 “auto’ 则其值会使项目的边距盒的尺寸尽可能接近所在的尺度,是同时会遵照: “min/max-width/height”属性的限制</p>
<p><strong>flex-wrap属性</strong><br>flex-wrap属性用于指定弹性盒子的子元素换行方式<br><strong>语法</strong><br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flex-wrap: nowrap | wrap | wrap-reverse | initial | inherit;</span><br></pre></td></tr></table></figure></p>
<p>各个值解析:<br>    · nowrap -默认,弹性容器为单行,该情况下弹性子项可能会溢出容器.<br>    · wrap -弹性容器为多行.该情况下弹性项溢出的部分会被放置到新行,子项内部会发生断行<br>    · wrap-reverse -反转wrap排列</p>
<p><strong>align-content 属性</strong></p>
<p>align-content 属性用于修改 flex-wrap 属性的行为。类似于 align-items, 但它不是设置弹性子元素的对齐，而是设置各个行的对齐。<br>语法<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">align-content: flex-start | flex-end | center | space-between | space-around | stretch</span><br></pre></td></tr></table></figure></p>
<p>各个值解析:</p>
<pre><code>stretch - 默认。各行将会伸展以占用剩余的空间。
flex-start - 各行向弹性盒容器的起始位置堆叠。
flex-end - 各行向弹性盒容器的结束位置堆叠。
center -各行向弹性盒容器的中间位置堆叠。
space-between -各行在弹性盒容器中平均分布。
space-around - 各行在弹性盒容器中平均分布，两端保留子元素与子元素之间间距大小的一半。
</code></pre>
          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/05/演示拖拽文本/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/03/05/演示拖拽文本/" class="post-title-link" itemprop="url">演示拖拽文本</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-03-05 16:44:23 / 修改时间：17:25:02" itemprop="dateCreated datePublished" datetime="2019-03-05T16:44:23+08:00">2019-03-05</time>
            

            
              

              
            
          </span>

          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="拖拽文本"><a href="#拖拽文本" class="headerlink" title="拖拽文本"></a>拖拽文本</h3><p>html结构<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">class</span>=<span class="string">"source"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">draggable</span>=<span class="string">"true"</span>&gt;</span>nihao12<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">draggable</span>=<span class="string">"true"</span>&gt;</span>nihao13<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">draggable</span>=<span class="string">"true"</span>&gt;</span>nihao14<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">draggable</span>=<span class="string">"true"</span>&gt;</span>nihao15<span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"target"</span> <span class="attr">contenteditable</span>=<span class="string">"true"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--存放拖拽元素文本内容的容器--&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>js结构<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    documment.addEventListener(<span class="string">"DOMContentLoaded"</span>,<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="comment">// 获取拖拽物</span></span><br><span class="line">       <span class="keyword">const</span> lis = <span class="built_in">document</span>.queryESlectorAll(<span class="string">".source li"</span>),</span><br><span class="line">            target = <span class="built_in">document</span>.querySelector(<span class="string">".taget"</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//给每个li绑定循环事件</span></span><br><span class="line">            [...lis].forEach(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="comment">//给li设置拖拽事件</span></span><br><span class="line">                li.ondragstart = <span class="function"><span class="keyword">function</span> (<span class="params">evt</span>) </span>&#123;</span><br><span class="line">                    <span class="comment">//在开始拖拽时  需要设置拖拽传输的数据</span></span><br><span class="line">                    <span class="comment">//拖拽事件对象event中保存了一个 datatransfer 对象  用来进行拖拽过程控制的数据</span></span><br><span class="line">                    <span class="built_in">console</span>.log(evt.dataTransfer)<span class="comment">//打印dataTransfer对象</span></span><br><span class="line">                    <span class="comment">//设置拖拽的形式为copy</span></span><br><span class="line">                    evt.dataTransfer.effectAllwoed = <span class="string">"copy"</span>;</span><br><span class="line">                    <span class="comment">//设置拖拽操作的数据setData</span></span><br><span class="line">                    evt.dataTransfer.setData(<span class="string">"text/plain"</span>,evt.target.textContent);</span><br><span class="line">                &#125;</span><br><span class="line">                li.ondrag = <span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line">                    <span class="comment">//拖拽过程中</span></span><br><span class="line">                &#125;</span><br><span class="line">                li.ondragleave = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                    <span class="comment">//拖拽源离开所在地</span></span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                <span class="comment">//来接收拖拽物  给到达目标设置拖拽事件</span></span><br><span class="line">                targt.ondragenter = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                    <span class="keyword">this</span>.style.borderColor = <span class="string">"red"</span>;</span><br><span class="line">                &#125; </span><br><span class="line">                target.ondragover = <span class="function"><span class="keyword">function</span> (<span class="params">evt</span>) </span>&#123;</span><br><span class="line">                    evt.dropEffect = <span class="string">"copy"</span>;</span><br><span class="line">                    <span class="comment">//设置目标区域可接收</span></span><br><span class="line">                    evt.preventDefault();</span><br><span class="line">                &#125; </span><br><span class="line">                target.ondragleave = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">                  <span class="comment">//拖拽物离开 回复之前的状态</span></span><br><span class="line">                  <span class="keyword">this</span>.style.borderColor = <span class="string">"#ccc"</span> ; </span><br><span class="line">                &#125;</span><br><span class="line">                target.ondrop = <span class="function"><span class="keyword">function</span> (<span class="params">evt</span>) </span>&#123;</span><br><span class="line">                    evt.preventDefault();</span><br><span class="line">                    evt.stopPropagation();</span><br><span class="line">                    <span class="comment">//阻止浏览器默认行为   设置拖拽源文件触发被下载或打开的默认行为</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                    <span class="comment">//使用 getData 来读取拖拽传输的数据</span></span><br><span class="line">                    <span class="keyword">const</span> txt = <span class="built_in">document</span>.createTextNode(<span class="string">""</span>);</span><br><span class="line">                    txt.nodeValue = evt.dataTransfer.getData(<span class="string">"text/plain"</span>);</span><br><span class="line">                    <span class="keyword">this</span>.appendChild(txt);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line"></span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/03/05/拖拽事件/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/03/05/拖拽事件/" class="post-title-link" itemprop="url">拖拽事件</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-03-05 14:43:02 / 修改时间：17:29:56" itemprop="dateCreated datePublished" datetime="2019-03-05T14:43:02+08:00">2019-03-05</time>
            

            
              

              
            
          </span>

          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="拖拽事件"><a href="#拖拽事件" class="headerlink" title="拖拽事件"></a>拖拽事件</h3><p>要实现拖拽 两点:</p>
<ol>
<li>被拖拽物必须可拖拽</li>
<li>目标区域可接收拖拽物</li>
</ol>
<p>拖拽源/被拖拽物体 的位置<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">被拖拽物的容器里必须有 draggable="true"属性</span><br><span class="line"> <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"source"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"libs/logo.png"</span> <span class="attr">alt</span>=<span class="string">""</span> <span class="attr">draggable</span>=<span class="string">"true"</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>存放拖拽物的目标区域<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"target"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>设置两个容器的 source target<br> width height border</p>
<p>script中设置<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">document</span>.querySelector(<span class="string">"DOMContentLoaded"</span>,<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 获取拖拽物</span></span><br><span class="line">    <span class="keyword">const</span> source = <span class="built_in">document</span>.querySelector(<span class="string">".source"</span>),</span><br><span class="line">        target = <span class="built_in">document</span>.querySelector(<span class="string">".target"</span>),</span><br><span class="line">        img = source.querySelector(<span class="string">"img"</span>);</span><br><span class="line">        <span class="comment">//拖拽事件 多数 以drag开始 它分为两个:</span></span><br><span class="line">        <span class="comment">//一个是在拖拽源所在区域 拖拽时拖拽源触发的事件</span></span><br><span class="line">        <span class="comment">//另一个是离开拖拽位置到达目标区域时 可以给目标区域添加拖拽监听的事件</span></span><br><span class="line">        img.ondragstart = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"开始拖拽"</span>);</span><br><span class="line">        &#125; </span><br><span class="line">        <span class="comment">//该事件在拖拽过程中 间隔几毫秒持续触发 除非其他时间打断</span></span><br><span class="line">        img.ondrag = <span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"拖拽中..."</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 该事件拖拽物离开所在的区域</span></span><br><span class="line">        img.ondragleave = <span class="function"><span class="keyword">function</span> (<span class="params"> </span>)</span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"离开所在的区域 "</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 接下来是 被拖拽物到达 目标的区域 设置拖拽的监听</span></span><br><span class="line">        <span class="comment">//接收的容器来接收</span></span><br><span class="line">        target.ondragenter =  <span class="function"><span class="keyword">function</span>  (<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"拖拽物来啦!!"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//over事件是一个状态事件  它同drag 一样 是持续触发的事件</span></span><br><span class="line">        <span class="comment">//不同的是 drag是拖拽源监听的 over 是目标元素监听的事件</span></span><br><span class="line">        target.ondragover = <span class="function"><span class="keyword">function</span> (<span class="params">evt</span>)</span>&#123;</span><br><span class="line">            evt.preventDefault();</span><br><span class="line">            <span class="built_in">console</span>.log(<span class="string">"被拖拽物放下"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//放下拖拽物时触发的事件 一般拖拽行为的控制 都在该函数中完成</span></span><br><span class="line">        target.ondrop = <span class="function"><span class="keyword">function</span> (<span class="params">evt</span>) </span>&#123;</span><br><span class="line">            evt.preventDefault();</span><br><span class="line">            evt.stopPropagation();</span><br><span class="line">            <span class="keyword">this</span>.appendChild(img);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/02/26/Map类型/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/26/Map类型/" class="post-title-link" itemprop="url">Map类型</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-02-26 19:42:05 / 修改时间：19:54:08" itemprop="dateCreated datePublished" datetime="2019-02-26T19:42:05+08:00">2019-02-26</time>
            

            
              

              
            
          </span>

          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Map类型"><a href="#Map类型" class="headerlink" title="Map类型"></a>Map类型</h1><p><strong>Map创建键值对的数据集合 支持各种类型的索引 (键.属性) 它是建立一个名和值的映射关系</strong><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> map = <span class="keyword">new</span> <span class="built_in">Map</span>();</span><br></pre></td></tr></table></figure></p>
<p>创建不同类型的索引<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> str = <span class="string">"hello"</span>,</span><br><span class="line">    obj = &#123;&#125;,</span><br><span class="line">    fn = <span class="function"><span class="params">()</span> =&gt;</span> &#123;&#125;;</span><br></pre></td></tr></table></figure></p>
<p>使用set方法 向map写入值<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">map.set(str,<span class="string">"字符串索引"</span>);</span><br><span class="line">map.set(obj,<span class="string">"对象索引的值"</span>);</span><br><span class="line">map.set(fn,<span class="string">"函数索引的值"</span>);</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(map);<span class="comment">//Map(3) &#123; hello → "字符串索引", &#123;&#125; → "对象索引的值", fn() → "函数索引的值" &#125;</span></span><br></pre></td></tr></table></figure></p>
<p>使用get方法 读取map元素的值<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(map.get(str),map.get(<span class="string">"hello"</span>));<span class="comment">//字符串索引 字符串索引</span></span><br><span class="line"><span class="built_in">console</span>.log(map.get(obj),map.get(&#123;&#125;));<span class="comment">//对象索引的值 undefined</span></span><br><span class="line"><span class="built_in">console</span>.log(map.get(fn));<span class="comment">//函数索引的值</span></span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/02/26/函数参数-fn-iterable/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/26/函数参数-fn-iterable/" class="post-title-link" itemprop="url">函数参数:fn([...iterable])</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-02-26 16:35:33 / 修改时间：19:06:35" itemprop="dateCreated datePublished" datetime="2019-02-26T16:35:33+08:00">2019-02-26</time>
            

            
              

              
            
          </span>

          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="函数参数-fn-…iterable"><a href="#函数参数-fn-…iterable" class="headerlink" title="函数参数 : fn([…iterable])"></a>函数参数 : fn([…iterable])</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">sum</span> (<span class="params">...args</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> tobal = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> val <span class="keyword">of</span> args) &#123;</span><br><span class="line">        total += val;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> total;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">console</span>.log(sum(<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>)); <span class="comment">//6</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</span><br><span class="line"><span class="built_in">console</span>.log(sum.apply(<span class="literal">null</span>,arr);<span class="comment">//6</span></span><br><span class="line"><span class="built_in">console</span>.log(sum(...arr)); <span class="comment">//6</span></span><br></pre></td></tr></table></figure>
<p><strong>构造函数–数组</strong><br>①.插入元素<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>],</span><br><span class="line">    arr1 = [<span class="string">"qwe"</span>,<span class="string">"rty"</span>];</span><br><span class="line">arr = [<span class="number">1</span>,<span class="number">2</span>,...arr1,<span class="number">3</span>];</span><br><span class="line"><span class="built_in">console</span>.log(arr); <span class="comment">//1,2,"qwe","rty",3</span></span><br></pre></td></tr></table></figure></p>
<p>②.数组拷贝<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> source = [<span class="string">"foo"</span>,<span class="string">"bar"</span>];</span><br><span class="line"><span class="comment">//在ES5中使用Object.assign()来浅拷贝一个人对象</span></span><br><span class="line"><span class="comment">//var target = Object.assign(&#123;&#125;,source);</span></span><br><span class="line"><span class="comment">//数组的slice方法,截取数组元素 并返回一个新数组</span></span><br><span class="line"><span class="keyword">var</span> target = source.slice();</span><br><span class="line"><span class="built_in">console</span>.log(source,target); <span class="comment">// Array ["foo","bar"]  Array ["foo","bar"]</span></span><br><span class="line"><span class="built_in">console</span>.log(source == target);<span class="comment">// false</span></span><br></pre></td></tr></table></figure></p>
<p>数组拷贝—–使用展开语法拷贝一个数组<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> target = [...source];</span><br><span class="line"><span class="built_in">console</span>.log(source,target); <span class="comment">//Array ["foo","bar"]  Array ["foo","bar"]</span></span><br><span class="line"><span class="built_in">console</span>.log(source == target); <span class="comment">//false</span></span><br></pre></td></tr></table></figure></p>
<p>③.数组合并<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr1 = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>],</span><br><span class="line">    arr2 = [<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>];</span><br><span class="line"><span class="keyword">var</span> p = arr1.conct(arr2);</span><br><span class="line">consloe.log(p);<span class="comment">// [1,2,3,4,4,5,6,7]</span></span><br></pre></td></tr></table></figure></p>
<p>数组合并—–使用展开语法<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr1 = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>],</span><br><span class="line">    arr2 = [<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>];</span><br><span class="line">pp = [...arr1,...arr2];</span><br><span class="line"><span class="built_in">console</span>.log(pp); <span class="comment">//[1,2,3,4,4,5,6,7]</span></span><br></pre></td></tr></table></figure></p>
<p><strong>构造函数–对象</strong><br>构造函数: 展开语法将已有对象的所有可枚举(enumerable)属性拷贝到新构造的对象中<br>①.对象拷贝<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> source = &#123;</span><br><span class="line">    foo : <span class="string">"foo"</span>,</span><br><span class="line">    bar : <span class="string">"bar"</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> target = &#123;</span><br><span class="line">    ...source</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">console</span>.log(source,target); <span class="comment">//Object &#123;foo : "foo", bar : "bar"&#125;   Object &#123;foo : "foo", bar : "bar"&#125;</span></span><br><span class="line"><span class="built_in">console</span>.log(source == target);  <span class="comment">//false</span></span><br></pre></td></tr></table></figure></p>
<p>②.合并对象<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> source = &#123;</span><br><span class="line">    name : <span class="string">"张三"</span>,</span><br><span class="line">    sex : <span class="string">"男"</span>,</span><br><span class="line">    foo : <span class="string">"foo"</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> target = &#123;</span><br><span class="line">    age : <span class="string">"22"</span>,</span><br><span class="line">    foo : <span class="string">"bar"</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> p = <span class="built_in">Object</span>.assign(source,target);</span><br><span class="line"><span class="built_in">console</span>.log(p); <span class="comment">//Object &#123;name : "张三",sex : "男", foo : "bar", age : "22"&#125;</span></span><br></pre></td></tr></table></figure></p>
<p>合并对象–使用展开<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">var</span> source = &#123;</span><br><span class="line">    name : <span class="string">"张三"</span>,</span><br><span class="line">    sex : <span class="string">"男"</span>,</span><br><span class="line">    foo : <span class="string">"foo"</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> target = &#123;</span><br><span class="line">    age : <span class="string">"22"</span>,</span><br><span class="line">    foo : <span class="string">"bar"</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> pp = &#123;</span><br><span class="line">    ...source,</span><br><span class="line">    ...target,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="built_in">console</span>.log(pp); <span class="comment">//Object &#123;name : "张三",sex : "男", foo : "bar", age : "22"&#125;</span></span><br></pre></td></tr></table></figure></p>
<p>当展开语法用于函数参数或者数组时,展开的必须是一个数组或者可迭代对象<br>当一个可迭代对象 被放入数组中展开时 返回的是一个提取了下标元素的真数组<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> arr = [...new <span class="built_in">String</span>(<span class="string">"hello"</span>)];</span><br><span class="line"><span class="built_in">console</span>.log(arr);<span class="comment">//  Array(5) [ "h", "e", "l", "l", "o" ]</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> arr3 = <span class="built_in">Array</span>.form(<span class="keyword">new</span> <span class="built_in">String</span>(<span class="string">"hello"</span>));</span><br><span class="line"><span class="built_in">console</span>.log(arr3);<span class="comment">//   Array(5) [ "h", "e", "l", "l", "o" ]</span></span><br></pre></td></tr></table></figure></p>
<p>eg:</p>
<pre><code class="html"><span class="tag">&lt;<span class="name">ul</span>&gt;</span>
    <span class="tag">&lt;<span class="name">li</span>&gt;</span>撒有哪啦<span class="tag">&lt;/<span class="name">li</span>&gt;</span>
    <span class="tag">&lt;<span class="name">li</span>&gt;</span>撒有哪啦<span class="tag">&lt;/<span class="name">li</span>&gt;</span>
    <span class="tag">&lt;<span class="name">li</span>&gt;</span>撒有哪啦<span class="tag">&lt;/<span class="name">li</span>&gt;</span>
    <span class="tag">&lt;<span class="name">li</span>&gt;</span>撒有哪啦<span class="tag">&lt;/<span class="name">li</span>&gt;</span>
<span class="tag">&lt;/<span class="name">ul</span>&gt;</span>
document.addEventListener('DOMContentLoaded',function(){
    var lis = document.querySelectorAll("li"); //伪数组
    [...lis].forEach((item,idx) =&gt; {
        console.log(item);//
    })
})
</code></pre>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/02/25/Promise/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/25/Promise/" class="post-title-link" itemprop="url">Promise</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-02-25 16:01:21 / 修改时间：19:36:15" itemprop="dateCreated datePublished" datetime="2019-02-25T16:01:21+08:00">2019-02-25</time>
            

            
              

              
            
          </span>

          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="promise-的含义"><a href="#promise-的含义" class="headerlink" title="promise 的含义"></a>promise 的含义</h1><p>Promise 是异步编程的一种解决方案,比传统的解决方案–回调函数和事件–更<br>合理和更强大.它由社区最早提出和实现,ES6将其写进了语言标准,统一用法,原<br>生提供了Promise对象</p>
<p>所谓 Promise,简单说就是一个容器,里面存着某个未来才会结束的事件(通常是一<br>个异步操作)的结果.从语法上说,Promise是一个对象,从它可以获取异步操作的<br>消息.Promise提供统一的 API,各种异步操作都可以同样的方法进行处理.</p>
<p>promise对象有以下两个特点.</p>
<p>(1)对象的状态不熟外界影响.Promise对象代表一个异步操作,有三种状态:pending<br>（进行中）、fulfilled（已成功）和rejected（已失败）。只有异步操作的结果，<br>可以决定当前是哪一种状态，任何其他操作都无法改变这个状态。这也是Promise这<br>个名字的由来，它的英语意思就是“承诺”，表示其他手段无法改变。</p>
<p>(2)一旦状态改变，就不会再变，任何时候都可以得到这个结果。Promise对象的状<br>态改变，只有两种可能：从pending变为fulfilled和从pending变为rejected。只<br>要这两种情况发生，状态就凝固了，不会再变了，会一直保持这个结果，这时就称为<br>resolved（已定型）。如果改变已经发生了，你再对Promise对象添加回调函数，也<br>会立即得到这个结果。这与事件（Event）完全不同，事件的特点是，如果你错过了<br>它，再去监听，是得不到结果的。</p>
<p>注意，为了行文方便，本章后面的resolved统一只指fulfilled状态，不包含rejected<br>状态</p>
<p>有了Promise对象，就可以将异步操作以同步操作的流程表达出来，避免了层层嵌套的回<br>调函数。此外，Promise对象提供统一的接口，使得控制异步操作更加容易。</p>
<p>Promise也有一些缺点。首先，无法取消Promise，一旦新建它就会立即执行，无法中途<br>取消。其次，如果不设置回调函数，Promise内部抛出的错误，不会反应到外部。第三，<br>当处于pending状态时，无法得知目前进展到哪一个阶段（刚刚开始还是即将完成）。</p>
<p>如果某些事件不断地反复发生，一般来说，使用 Stream 模式是比部署Promise更好的选择。</p>
<h1 id="基本用法"><a href="#基本用法" class="headerlink" title="基本用法"></a>基本用法</h1><p>ES6规定,Promise对象是一个构造函数,用来生成promise实例.</p>
<p>下面代码创造了一个Promise实例.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> promise = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve,reject</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="comment">/*异步操作成功*/</span>)&#123;</span><br><span class="line">        resolve(value);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        reject(error);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<p>Promise构造函数接收一个函数作为参数, 该函数的两个参数分别是resolve和reject.<br>它们是两个函数,由于 JavaScript引擎提供,不用自己部署.</p>
<p>resolve函数的作用是,将Promise对象的状态从”未完成”变为”成功”(即从 pending<br>变为resolve),在异步操作成功时调用,并将异步操作的结果,作为参数传递出去,reject<br>函数的作用是,将Promise对象的状态从”未完成”变为”失败”(即从pending变为 reject),<br>在异步操作失败时调用,并将异步操作报错的错误,作为参数传递出去.</p>
<p>Promise实例生成以后,可以用then方法分别指定resolve状态和rejected状态的回调函数.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">promise.then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="comment">//success</span></span><br><span class="line">&#125;,<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="comment">//failure</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>then方法可以接受两个回调函数作为参数.第一个回调函数是promise对象的状态变为resolve<br>时调用,第二个回调函数是Promise对象的状态变为rejected时调用.其中,第二个函数是可选的,<br>不一定要提供.这两个函数都接受Promise对象传出的值作为参数.</p>
<p>下面是一个Promise对象的简单例子.<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">timeout</span>(<span class="params">ms</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve,reject</span>) =&gt;</span> &#123;</span><br><span class="line">        setTimeout(resolve,ms,<span class="string">'done'</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">timeout(<span class="number">100</span>).then(<span class="function">(<span class="params">value</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(value);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p>
<p>上面代码中,timeout方法返回一个Promise实例,表示一段时间以后才会发生的结果.过了指定的<br>时间(ms参数)以后,Promise实例的状态变为resolve,就会触发then方法绑定的回调函数.</p>
<p>promise 新建后就会立即执行.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> promise = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve,reject</span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'Promise'</span>);</span><br><span class="line">    resolve();</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">promise.then(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'resolved.'</span>);</span><br><span class="line">&#125;)</span><br><span class="line"><span class="built_in">console</span>.log</span><br><span class="line"><span class="comment">//Promise</span></span><br><span class="line"><span class="comment">//Hi!</span></span><br><span class="line"><span class="comment">//resolved</span></span><br></pre></td></tr></table></figure>
<p>上面代码中,Promise新建后立即执行,所以首先输出的是Promise.然后,then方法指定的回调函数,<br>将在当前脚本所有同步任务执行完才会执行,所以Promise最后输出</p>
<p>下面是异步加载图片的例子.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">loadImageAsync</span>(<span class="params">url</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> image = <span class="keyword">new</span> Image();</span><br><span class="line"></span><br><span class="line">    image.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      resolve(image);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    image.onerror = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      reject(<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'Could not load image at '</span> + url));</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    image.src = url;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面代码中，使用Promise包装了一个图片加载的异步操作。如果加载成功，就调用resolve方法，<br>否则就调用reject方法</p>
<p>下面是一个用Promise对象实现的 Ajax 操作的例子.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> getJSON = <span class="function"><span class="keyword">function</span>(<span class="params">url</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> promise = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span>(<span class="params">resolve, reject</span>)</span>&#123;</span><br><span class="line">    <span class="keyword">const</span> handler = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">this</span>.readyState !== <span class="number">4</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">this</span>.status === <span class="number">200</span>) &#123;</span><br><span class="line">        resolve(<span class="keyword">this</span>.response);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        reject(<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="keyword">this</span>.statusText));</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">const</span> client = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">    client.open(<span class="string">"GET"</span>, url);</span><br><span class="line">    client.onreadystatechange = handler;</span><br><span class="line">    client.responseType = <span class="string">"json"</span>;</span><br><span class="line">    client.setRequestHeader(<span class="string">"Accept"</span>, <span class="string">"application/json"</span>);</span><br><span class="line">    client.send();</span><br><span class="line"></span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> promise;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">getJSON(<span class="string">"/posts.json"</span>).then(<span class="function"><span class="keyword">function</span>(<span class="params">json</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="string">'Contents: '</span> + json);</span><br><span class="line">&#125;, <span class="function"><span class="keyword">function</span>(<span class="params">error</span>) </span>&#123;</span><br><span class="line">  <span class="built_in">console</span>.error(<span class="string">'出错了'</span>, error);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>上面代码中，getJSON是对 XMLHttpRequest 对象的封装，用于发出一个针对 JSON 数据的<br> HTTP 请求，并且返回一个Promise对象。需要注意的是，在getJSON内部，resolve函数和<br> reject函数调用时，都带有参数。</p>
<p>如果调用resolve函数和reject函数时带有参数，那么它们的参数会被传递给回调函数。<br>reject函数的参数通常是Error对象的实例，表示抛出的错误；resolve函数的参数除了正常<br>的值以外，还可能是另一个 Promise 实例，比如像下面这样。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> p1 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> p2 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">  <span class="comment">// ...</span></span><br><span class="line">  resolve(p1);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>上面代码中，p1和p2都是 Promise 的实例，但是p2的resolve方法将p1作为参数，即一个异<br>步操作的结果是返回另一个异步操作。</p>
<p>注意，这时p1的状态就会传递给p2，也就是说，p1的状态决定了p2的状态。如果p1的状态是<br>pending，那么p2的回调函数就会等待p1的状态改变；如果p1的状态已经是resolved或者<br>rejected，那么p2的回调函数将会立刻执行<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> p1 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">  setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> reject(<span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">'fail'</span>)), <span class="number">3000</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> p2 = <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="keyword">function</span> (<span class="params">resolve, reject</span>) </span>&#123;</span><br><span class="line">  setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> resolve(p1), <span class="number">1000</span>)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">p2</span><br><span class="line">  .then(<span class="function"><span class="params">result</span> =&gt;</span> <span class="built_in">console</span>.log(result))</span><br><span class="line">  .catch(<span class="function"><span class="params">error</span> =&gt;</span> <span class="built_in">console</span>.log(error))</span><br><span class="line"><span class="comment">// Error: fail</span></span><br></pre></td></tr></table></figure></p>
<p>上面代码中，p1是一个 Promise，3 秒之后变为rejected。p2的状态在 1 秒之后改变，<br>resolve方法返回的是p1。由于p2返回的是另一个 Promise，导致p2自己的状态无效了，<br>由p1的状态决定p2的状态。所以，后面的then语句都变成针对后者（p1）。又过了 2 秒，<br>p1变为rejected，导致触发catch方法指定的回调函数。</p>
<p>注意，调用resolve或reject并不会终结 Promise 的参数函数的执行。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  resolve(<span class="number">1</span>);</span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">2</span>);</span><br><span class="line">&#125;).then(<span class="function"><span class="params">r</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(r);</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">// 2</span></span><br><span class="line"><span class="comment">//</span></span><br></pre></td></tr></table></figure></p>
<p>上面代码中，调用resolve(1)以后，后面的console.log(2)还是会执行，并且会首先打印出来。<br>这是因为立即 resolved 的 Promise 是在本轮事件循环的末尾执行，总是晚于本轮循环的同步任务。</p>
<p>一般来说，调用resolve或reject以后，Promise 的使命就完成了，后继操作应该放到then方法里面，<br>而不应该直接写在resolve或reject的后面。所以，最好在它们前面加上return语句，这样就不会有意外。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> resolve(<span class="number">1</span>);</span><br><span class="line">  <span class="comment">// 后面的语句不会执行</span></span><br><span class="line">  <span class="built_in">console</span>.log(<span class="number">2</span>);</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/02/25/异步编程/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                
                <a href="/2019/02/25/异步编程/" class="post-title-link" itemprop="url">异步编程</a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-02-25 15:27:50 / 修改时间：15:51:34" itemprop="dateCreated datePublished" datetime="2019-02-25T15:27:50+08:00">2019-02-25</time>
            

            
              

              
            
          </span>

          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="异步编程"><a href="#异步编程" class="headerlink" title="异步编程"></a>异步编程</h1><p>异步行为是javascript开发的常见景象: 例如 事件模型. setTimeout 延迟执行. Ajax操作<br>而异步编程是控制持续一段时间的程序行为,程序中一部分是现在执行 另一部分是在将来运行<br>在未来执行的部分 通过回调函数设置,回调是有效的解决异步编程的方式 但是页带来了一些新的问题<br>列如: 程序和逻辑的混乱<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest,</span><br><span class="line">    result;</span><br><span class="line"><span class="comment">//注册请求完成时的动作</span></span><br><span class="line">xhr.onloadend = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">this</span>.status == <span class="number">200</span>)&#123; <span class="comment">//请求成功</span></span><br><span class="line">        result = <span class="keyword">this</span>.responseText;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line">和服务器建立连接</span><br><span class="line">xhr.open(<span class="string">"GET"</span>,<span class="string">"http://localhost"</span>); <span class="comment">//设置请求行</span></span><br><span class="line">xhr.setRequesHeader(); <span class="comment">//设置请求头</span></span><br><span class="line">发送请求的执行方法</span><br><span class="line">xhr.send(<span class="literal">null</span>); <span class="comment">//设置请求体</span></span><br><span class="line">查看Ajax执行的结果</span><br><span class="line"><span class="built_in">console</span>.log(result);  <span class="comment">//undefined</span></span><br></pre></td></tr></table></figure></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest;,</span><br><span class="line">    resolve = <span class="function"><span class="params">()</span> =&gt;</span> &#123;&#125;,</span><br><span class="line">    reject = <span class="function"><span class="params">()</span> =&gt;</span> &#123;&#125;;</span><br><span class="line">注册请求完成时的动作</span><br><span class="line">xhr.onloadend = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">this</span>.status == <span class="number">200</span>)&#123; <span class="comment">//请求成功</span></span><br><span class="line">        <span class="comment">//result = this.responseText;</span></span><br><span class="line">        <span class="comment">//console.log(result);  //hello world</span></span><br><span class="line">        <span class="comment">//所有的相应行为 都必须放到回调函数中设置</span></span><br><span class="line">        <span class="comment">//当代码较多时  会放在不同的函数处理 维护性差</span></span><br><span class="line">        resolve(<span class="keyword">this</span>.responseText); <span class="comment">//成功时 决定执行的</span></span><br><span class="line"></span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        reject(<span class="keyword">this</span>.statusText);  <span class="comment">//失败时 拒绝的处理</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">和服务器建立连接</span><br><span class="line">xhr.open(<span class="string">"GET"</span>,<span class="string">"http://localhost"</span>);  <span class="comment">//设置请求行</span></span><br><span class="line">xhr.setRequesHeader();  <span class="comment">//设置请求头</span></span><br><span class="line">发送请求的执行方法</span><br><span class="line">xhr.send(<span class="literal">null</span>); <span class="comment">//设置请求体</span></span><br></pre></td></tr></table></figure>
          
        
      
    </div>

    

    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="下一页"></i></a>
  </nav>



          </div>
          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <div class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">John Doe</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">18</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  
                    
                    
                      
                    
                    <span class="site-state-item-count">1</span>
                    <span class="site-state-item-name">分类</span>
                  
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">3</span>
                    <span class="site-state-item-name">标签</span>
                  
                </div>
              
            </nav>
          

          

          

          

          
          

          
            
          
          

        </div>
      </div>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">John Doe</span>

  

  
</div>


  <div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v3.8.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> v7.0.0</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/src/utils.js?v=7.0.0"></script>

  <script src="/js/src/motion.js?v=7.0.0"></script>



  
  


  <script src="/js/src/schemes/muse.js?v=7.0.0"></script>



  

  


  <script src="/js/src/bootstrap.js?v=7.0.0"></script>



  



  




  

  

  

  

  

  

  

  

  

  

  

  

  

</body>
</html>
